<!DOCTYPE html>
<html lang="en">
<div><span style="background-color: #96CC9F">#include &ltiostream&gt </span><br>
<span style="background-color: #96CC9F">#include &ltvector&gt </span><br>
<span style="background-color: #00FF00">#include&ltalgorithm&gt </span><br>
<span style="background-color: #00FF00">#include&ltcmath&gt </span><br>
<span style="background-color: #96CC9F">using </span><span style="background-color: #96CC9F">namespace </span><span style="background-color: #96CC9F">std </span><span style="background-color: #96CC9F">; </span><span style="background-color: #CD5C5C"></span><br>
<span style="background-color: #FFD700">const </span><span style="background-color: #FFD700">int </span><span style="background-color: #FFD700">inf </span><span style="background-color: #FFD700">= </span><span style="background-color: #FFD700">1e9 </span><span style="background-color: #FFD700">; </span><br>
<br>
<br>
<span style="background-color: #FFD700">int </span><span style="background-color: #FFD700">main </span><span style="background-color: #FFD700">( </span><span style="background-color: #FFD700">) </span><span style="background-color: #FFD700">{ </span><br>
<span style="background-color: #96CC9F">&nbsp&nbsp&nbsp&nbspint </span><span style="background-color: #FFD700">n </span><span style="background-color: #FFD700">, </span><span style="background-color: #FFD700">s </span><span style="background-color: #FFD700">, </span><span style="background-color: #FFD700">f </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbspcin </span><span style="background-color: #FFD700">&gt </span><span style="background-color: #FFD700">&gt </span><span style="background-color: #FFD700">n </span><span style="background-color: #FFD700">&gt </span><span style="background-color: #FFD700">&gt </span><span style="background-color: #96CC9F">s </span><span style="background-color: #CD5C5C"></span><span style="background-color: #FFD700">&gt </span><span style="background-color: #FFD700">&gt </span><span style="background-color: #FFD700">f </span><span style="background-color: #96CC9F">; </span><span style="background-color: #CD5C5C"></span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsps </span><span style="background-color: #FFD700">-- </span><span style="background-color: #FFD700">; </span><span style="background-color: #FFD700">f </span><span style="background-color: #FFD700">-- </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbspvector </span><span style="background-color: #FFD700">&lt </span><span style="background-color: #FFD700">int </span><span style="background-color: #FFD700">&gt </span><span style="background-color: #FFD700">d </span><span style="background-color: #FFD700">( </span><span style="background-color: #FFD700">n </span><span style="background-color: #FFD700">, </span><span style="background-color: #FFD700">inf </span><span style="background-color: #FFD700">) </span><span style="background-color: #FFD700">, </span><span style="background-color: #FFD700">p </span><span style="background-color: #FFD700">( </span><span style="background-color: #FFD700">n </span><span style="background-color: #FFD700">) </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbspvector </span><span style="background-color: #FFD700">&lt </span><span style="background-color: #FFD700">int </span><span style="background-color: #FFD700">&gt </span><span style="background-color: #FFD700">u </span><span style="background-color: #FFD700">( </span><span style="background-color: #FFD700">n </span><span style="background-color: #FFD700">) </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbspvector </span><span style="background-color: #FFD700">&lt </span><span style="background-color: #FFD700">vector </span><span style="background-color: #FFD700">&lt </span><span style="background-color: #FFD700">pair </span><span style="background-color: #FFD700">&lt </span><span style="background-color: #FFD700">int </span><span style="background-color: #FFD700">, </span><span style="background-color: #FFD700">int </span><span style="background-color: #FFD700">&gt </span><span style="background-color: #FFD700">&gt </span><span style="background-color: #FFD700">&gt </span><span style="background-color: #FFD700">g </span><span style="background-color: #FFD700">( </span><span style="background-color: #FFD700">n </span><span style="background-color: #FFD700">) </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbspfor </span><span style="background-color: #96CC9F">( </span><span style="background-color: #CD5C5C"></span><span style="background-color: #FFD700">int </span><span style="background-color: #FFD700">i </span><span style="background-color: #FFD700">= </span><span style="background-color: #FFD700">0 </span><span style="background-color: #96CC9F">; </span><span style="background-color: #CD5C5C"></span><span style="background-color: #FFD700">i </span><span style="background-color: #FFD700">&lt </span><span style="background-color: #96CC9F">n </span><span style="background-color: #96CC9F">; </span><span style="background-color: #CD5C5C"></span><span style="background-color: #CD5C5C"></span><span style="background-color: #FFD700">i </span><span style="background-color: #FFD700">++ </span><span style="background-color: #FFD700">) </span><span style="background-color: #FFD700">{ </span><br>
<span style="background-color: #96CC9F">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfor </span><span style="background-color: #96CC9F">( </span><span style="background-color: #96CC9F">int </span><span style="background-color: #FFD700">j </span><span style="background-color: #96CC9F">= </span><span style="background-color: #FFD700">0 </span><span style="background-color: #96CC9F">; </span><span style="background-color: #FFD700">j </span><span style="background-color: #FFD700">&lt </span><span style="background-color: #96CC9F">n </span><span style="background-color: #96CC9F">; </span><span style="background-color: #FFD700">j </span><span style="background-color: #96CC9F">++ </span><span style="background-color: #96CC9F">) </span><span style="background-color: #96CC9F">{ </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspint </span><span style="background-color: #FFD700">q </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspscanf </span><span style="background-color: #FFD700">( </span><span style="background-color: #FFD700">"%d" </span><span style="background-color: #FFD700">, </span><span style="background-color: #FFD700">& </span><span style="background-color: #FFD700">q </span><span style="background-color: #FFD700">) </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspif </span><span style="background-color: #96CC9F">( </span><span style="background-color: #96CC9F">i </span><span style="background-color: #00FF00">&gt </span><span style="background-color: #00FF00">0 </span><span style="background-color: #96CC9F">) </span><span style="background-color: #FFD700">{ </span><br>
<br>
<span style="background-color: #96CC9F">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp} </span><br>
<span style="background-color: #96CC9F">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp} </span><span style="background-color: #CD5C5C"></span><span style="background-color: #CD5C5C"></span><span style="background-color: #CD5C5C"></span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp} </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbspd </span><span style="background-color: #FFD700">[ </span><span style="background-color: #FFD700">s </span><span style="background-color: #FFD700">] </span><span style="background-color: #FFD700">= </span><span style="background-color: #FFD700">0 </span><span style="background-color: #96CC9F">; </span><br>
<span style="background-color: #96CC9F">&nbsp&nbsp&nbsp&nbspfor </span><span style="background-color: #96CC9F">( </span><span style="background-color: #96CC9F">int </span><span style="background-color: #96CC9F">i </span><span style="background-color: #96CC9F">= </span><span style="background-color: #96CC9F">0 </span><span style="background-color: #96CC9F">; </span><span style="background-color: #96CC9F">i </span><span style="background-color: #96CC9F">&lt </span><span style="background-color: #FFD700">n </span><span style="background-color: #FFD700">; </span><span style="background-color: #FFD700">++ </span><span style="background-color: #FFD700">i </span><span style="background-color: #96CC9F">) </span><span style="background-color: #00FF00">{ </span><br>
<span style="background-color: #00FF00">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspint </span><span style="background-color: #FFD700">v </span><span style="background-color: #FFD700">= </span><span style="background-color: #FFD700">- </span><span style="background-color: #FFD700">1 </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #96CC9F">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfor </span><span style="background-color: #96CC9F">( </span><span style="background-color: #96CC9F">int </span><span style="background-color: #96CC9F">j </span><span style="background-color: #96CC9F">= </span><span style="background-color: #CD5C5C"></span><span style="background-color: #CD5C5C"></span><span style="background-color: #FFD700">0 </span><span style="background-color: #96CC9F">; </span><span style="background-color: #96CC9F">j </span><span style="background-color: #96CC9F">&lt </span><span style="background-color: #CD5C5C"></span><span style="background-color: #CD5C5C"></span><span style="background-color: #CD5C5C"></span><span style="background-color: #CD5C5C"></span><span style="background-color: #FFD700">n </span><span style="background-color: #96CC9F">; </span><span style="background-color: #CD5C5C"></span><span style="background-color: #96CC9F">++ </span><span style="background-color: #FFD700">j </span><span style="background-color: #FFD700">) </span><br>
<span style="background-color: #96CC9F">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspif </span><span style="background-color: #96CC9F">( </span><span style="background-color: #00FF00">! </span><span style="background-color: #FFD700">u </span><span style="background-color: #96CC9F">[ </span><span style="background-color: #96CC9F">j </span><span style="background-color: #96CC9F">] </span><span style="background-color: #CD5C5C"></span><span style="background-color: #CD5C5C"></span><span style="background-color: #FFD700">&& </span><span style="background-color: #FFD700">( </span><span style="background-color: #FFD700">v </span><span style="background-color: #96CC9F">== </span><span style="background-color: #CD5C5C"></span><span style="background-color: #CD5C5C"></span><span style="background-color: #CD5C5C"></span><span style="background-color: #FFD700">- </span><span style="background-color: #FFD700">1 </span><span style="background-color: #FFD700">|| </span><span style="background-color: #FFD700">d </span><span style="background-color: #96CC9F">[ </span><span style="background-color: #FFD700">j </span><span style="background-color: #96CC9F">] </span><span style="background-color: #FFD700">&lt </span><span style="background-color: #FFD700">d </span><span style="background-color: #96CC9F">[ </span><span style="background-color: #FFD700">v </span><span style="background-color: #96CC9F">] </span><span style="background-color: #96CC9F">) </span><span style="background-color: #96CC9F">) </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspv </span><span style="background-color: #FFD700">= </span><span style="background-color: #FFD700">j </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspif </span><span style="background-color: #FFD700">( </span><span style="background-color: #FFD700">d </span><span style="background-color: #96CC9F">[ </span><span style="background-color: #FFD700">v </span><span style="background-color: #96CC9F">] </span><span style="background-color: #00FF00">== </span><span style="background-color: #00FF00">inf </span><span style="background-color: #00FF00">) </span><span style="background-color: #00FF00">break </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspu </span><span style="background-color: #96CC9F">[ </span><span style="background-color: #FFD700">v </span><span style="background-color: #96CC9F">] </span><span style="background-color: #FFD700">= </span><span style="background-color: #FFD700">true </span><span style="background-color: #96CC9F">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfor </span><span style="background-color: #FFD700">( </span><span style="background-color: #FFD700">auto </span><span style="background-color: #FFD700">j </span><span style="background-color: #FFD700">: </span><span style="background-color: #FFD700">g </span><span style="background-color: #FFD700">[ </span><span style="background-color: #FFD700">v </span><span style="background-color: #FFD700">] </span><span style="background-color: #FFD700">) </span><span style="background-color: #FFD700">{ </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspint </span><span style="background-color: #FFD700">to </span><span style="background-color: #FFD700">= </span><span style="background-color: #FFD700">j </span><span style="background-color: #FFD700">. </span><span style="background-color: #FFD700">first </span><span style="background-color: #96CC9F">; </span><br>
<span style="background-color: #00FF00">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspint </span><span style="background-color: #FFD700">len </span><span style="background-color: #FFD700">= </span><span style="background-color: #FFD700">j </span><span style="background-color: #96CC9F">. </span><span style="background-color: #FFD700">second </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspif </span><span style="background-color: #FFD700">( </span><span style="background-color: #FFD700">d </span><span style="background-color: #FFD700">[ </span><span style="background-color: #FFD700">v </span><span style="background-color: #FFD700">] </span><span style="background-color: #FFD700">+ </span><span style="background-color: #FFD700">len </span><span style="background-color: #96CC9F">&lt </span><span style="background-color: #FFD700">d </span><span style="background-color: #96CC9F">[ </span><span style="background-color: #FFD700">to </span><span style="background-color: #96CC9F">] </span><span style="background-color: #FFD700">) </span><span style="background-color: #FFD700">{ </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspd </span><span style="background-color: #FFD700">[ </span><span style="background-color: #FFD700">to </span><span style="background-color: #FFD700">] </span><span style="background-color: #FFD700">= </span><span style="background-color: #FFD700">d </span><span style="background-color: #FFD700">[ </span><span style="background-color: #FFD700">v </span><span style="background-color: #FFD700">] </span><span style="background-color: #FFD700">+ </span><span style="background-color: #FFD700">len </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspp </span><span style="background-color: #FFD700">[ </span><span style="background-color: #FFD700">to </span><span style="background-color: #FFD700">] </span><span style="background-color: #FFD700">= </span><span style="background-color: #FFD700">v </span><span style="background-color: #FFD700">; </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp} </span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp} </span><br>
<br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbsp} </span><br>
<span style="background-color: #96CC9F">&nbsp&nbsp&nbsp&nbspcout </span><span style="background-color: #96CC9F">&lt </span><span style="background-color: #96CC9F">&lt </span><span style="background-color: #00FF00">( </span><span style="background-color: #FFD700">d </span><span style="background-color: #96CC9F">[ </span><span style="background-color: #FFD700">f </span><span style="background-color: #96CC9F">] </span><span style="background-color: #CD5C5C"></span><span style="background-color: #FFD700">== </span><span style="background-color: #FFD700">inf </span><span style="background-color: #FFD700">? </span><span style="background-color: #FFD700">- </span><span style="background-color: #FFD700">1 </span><span style="background-color: #FFD700">: </span><span style="background-color: #FFD700">d </span><span style="background-color: #96CC9F">[ </span><span style="background-color: #FFD700">f </span><span style="background-color: #96CC9F">] </span><span style="background-color: #CD5C5C"></span><span style="background-color: #FFD700">) </span><span style="background-color: #96CC9F">&lt </span><span style="background-color: #96CC9F">&lt </span><span style="background-color: #96CC9F">endl </span><span style="background-color: #96CC9F">; </span><span style="background-color: #CD5C5C"></span><span style="background-color: #CD5C5C"></span><span style="background-color: #CD5C5C"></span><br>
<span style="background-color: #FFD700">&nbsp&nbsp&nbsp&nbspreturn </span><span style="background-color: #FFD700">0 </span><span style="background-color: #96CC9F">; </span><br>
<span style="background-color: #96CC9F">} </span><span style="background-color: #96CC9F">&ltEOF&gt </span></div>
</html>